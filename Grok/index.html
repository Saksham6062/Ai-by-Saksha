<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grok Models Interface</title>
<style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f4f4f8; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    select, textarea, input { width: 100%; padding: 8px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { padding: 10px 20px; margin-top: 10px; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 5px; }
    button:hover { background: #0056b3; }
    #chat-container { margin-top: 20px; border: 1px solid #ddd; border-radius: 8px; background: white; padding: 10px; max-height: 500px; overflow-y: auto; }
    .message { margin-bottom: 15px; padding: 8px 12px; border-radius: 6px; }
    .user { background: #d1e7ff; text-align: right; }
    .assistant { background: #f1f1f1; text-align: left; }
    .model-badge { display: inline-block; padding: 2px 8px; background: #007bff33; color: #007bff; border-radius: 12px; font-size: 11px; margin-bottom: 4px; }
</style>
</head>
<body>

<h1>Grok Models with Modes</h1>

<label for="api-key">API Key (Required):</label>
<input type="password" id="api-key" placeholder="Enter your xAI API key">

<label for="model">Select Model:</label>
<select id="model">
    <option value="grok-3">Grok-3</option>
    <option value="grok-3-mini">Grok-3 Mini</option>
    <option value="grok-4-fast-reasoning">Grok-4 Fast Reasoning</option>
    <option value="grok-4-fast-non-reasoning">Grok-4 Fast Non-Reasoning</option>
    <option value="grok-4-0709">Grok-4-0709</option>
    <option value="grok-code-fast-1">Grok-Code-Fast-1</option>
</select>

<label for="mode">Select Mode:</label>
<select id="mode">
    <option value="standard">Standard</option>
    <option value="canva">Canva (Creative Design)</option>
    <option value="deepthink">DeepThink (Reasoning)</option>
    <option value="deepresearch">Deep Research (With Search)</option>
</select>

<label for="prompt">Your Prompt:</label>
<textarea id="prompt" rows="4" placeholder="Enter your question or prompt..."></textarea>

<button onclick="generateResponse()">Generate Response</button>

<div id="chat-container"></div>

<script>
let conversationHistory = [];

async function generateResponse() {
    const apiKey = document.getElementById('api-key').value.trim();
    const model = document.getElementById('model').value;
    const mode = document.getElementById('mode').value;
    const prompt = document.getElementById('prompt').value.trim();
    const chatContainer = document.getElementById('chat-container');

    if (!apiKey) { alert('Please enter your API key.'); return; }
    if (!prompt) { alert('Please enter a prompt.'); return; }

    // Add user message
    addMessage('user', prompt, model, mode);

    document.getElementById('prompt').value = '';
    addMessage('assistant', 'Generating response...', model, mode, true);

    let systemPrompt = '';
    let searchParams = null;

    switch(mode) {
        case 'canva':
            systemPrompt = 'You are a creative design assistant like Canva. Provide ideas, descriptions, or step-by-step guides for visual designs, graphics, and layouts.';
            break;
        case 'deepthink':
            systemPrompt = 'You are a deep thinking AI. Analyze the query thoroughly, break it down step by step, and provide insightful, reasoned responses.';
            break;
        case 'deepresearch':
            systemPrompt = 'You are a research assistant. Use available tools to gather and synthesize information for a comprehensive answer.';
            searchParams = { mode: 'on', return_citations: true };
            break;
        default:
            systemPrompt = 'You are Grok, a helpful and maximally truthful AI built by xAI.';
    }

    conversationHistory.push({ role: 'system', content: systemPrompt });
    conversationHistory.push({ role: 'user', content: prompt });

    const payload = {
        model: model,
        messages: conversationHistory,
        temperature: 0.7,
        max_tokens: 1000
    };

    if (searchParams) payload.search_parameters = searchParams;

    try {
        const res = await fetch('https://api.x.ai/v1/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${apiKey}`
            },
            body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error(`API error: ${res.status} ${res.statusText}`);

        const data = await res.json();

        // Detect response structure
        let answer = '';
        if (data.choices && data.choices[0]) {
            if (data.choices[0].message) answer = data.choices[0].message.content || '';
            else if (data.choices[0].content && data.choices[0].content[0]) answer = data.choices[0].content[0].text || '';
        }

        // Remove "Generating response..." message
        chatContainer.lastChild.remove();
        addMessage('assistant', answer, model, mode);
        conversationHistory.push({ role: 'assistant', content: answer });

        // Scroll to bottom
        chatContainer.scrollTop = chatContainer.scrollHeight;

    } catch (error) {
        chatContainer.lastChild.remove();
        addMessage('assistant', `Error: ${error.message}`, model, mode);
    }
}

function addMessage(role, content, model, mode, isLoading=false) {
    const chatContainer = document.getElementById('chat-container');
    const msgDiv = document.createElement('div');
    msgDiv.className = `message ${role}`;

    if (!isLoading) {
        const badge = document.createElement('div');
        badge.className = 'model-badge';
        badge.textContent = `${model} - ${mode}`;
        msgDiv.appendChild(badge);
    }

    msgDiv.appendChild(document.createTextNode(content));
    chatContainer.appendChild(msgDiv);
    chatContainer.scrollTop = chatContainer.scrollHeight;
}
</script>

</body>
</html>
